_meta:
  source: SKILL.md
  format_version: '1.0'
frontmatter:
  name: tmux
  description: Remote-control tmux sessions for interactive CLIs by sending keystrokes
    and scraping pane output.
  metadata:
    nanobot:
      emoji: üßµ
      os:
      - darwin
      - linux
      requires:
        bins:
        - tmux
title: tmux Skill
sections:
- title: tmux Skill
  content: Use tmux only when you need an interactive TTY. Prefer exec background
    mode for long-running, non-interactive tasks.
  subsections:
  - title: Quickstart (isolated socket, exec tool)
    content: 'After starting a session, always print monitor commands:'
    code_blocks:
    - language: bash
      content: 'SOCKET_DIR="${NANOBOT_TMUX_SOCKET_DIR:-${TMPDIR:-/tmp}/nanobot-tmux-sockets}"

        mkdir -p "$SOCKET_DIR"

        SOCKET="$SOCKET_DIR/nanobot.sock"

        SESSION=nanobot-python


        tmux -S "$SOCKET" new -d -s "$SESSION" -n shell

        tmux -S "$SOCKET" send-keys -t "$SESSION":0.0 -- ''PYTHON_BASIC_REPL=1 python3
        -q'' Enter

        tmux -S "$SOCKET" capture-pane -p -J -t "$SESSION":0.0 -S -200'
    - language: ''
      content: "To monitor:\n  tmux -S \"$SOCKET\" attach -t \"$SESSION\"\n  tmux\
        \ -S \"$SOCKET\" capture-pane -p -J -t \"$SESSION\":0.0 -S -200"
  - title: Socket convention
    content: '- Use `NANOBOT_TMUX_SOCKET_DIR` environment variable.

      - Default socket path: `"$NANOBOT_TMUX_SOCKET_DIR/nanobot.sock"`.'
    lists:
    - type: bullet
      items:
      - Use `NANOBOT_TMUX_SOCKET_DIR` environment variable.
      - 'Default socket path: `"$NANOBOT_TMUX_SOCKET_DIR/nanobot.sock"`.'
  - title: Targeting panes and naming
    content: '- Target format: `session:window.pane` (defaults to `:0.0`).

      - Keep names short; avoid spaces.

      - Inspect: `tmux -S "$SOCKET" list-sessions`, `tmux -S "$SOCKET" list-panes
      -a`.'
    lists:
    - type: bullet
      items:
      - 'Target format: `session:window.pane` (defaults to `:0.0`).'
      - Keep names short; avoid spaces.
      - 'Inspect: `tmux -S "$SOCKET" list-sessions`, `tmux -S "$SOCKET" list-panes
        -a`.'
  - title: Finding sessions
    content: '- List sessions on your socket: `{baseDir}/scripts/find-sessions.sh
      -S "$SOCKET"`.

      - Scan all sockets: `{baseDir}/scripts/find-sessions.sh --all` (uses `NANOBOT_TMUX_SOCKET_DIR`).'
    lists:
    - type: bullet
      items:
      - 'List sessions on your socket: `{baseDir}/scripts/find-sessions.sh -S "$SOCKET"`.'
      - 'Scan all sockets: `{baseDir}/scripts/find-sessions.sh --all` (uses `NANOBOT_TMUX_SOCKET_DIR`).'
  - title: Sending input safely
    content: '- Prefer literal sends: `tmux -S "$SOCKET" send-keys -t target -l --
      "$cmd"`.

      - Control keys: `tmux -S "$SOCKET" send-keys -t target C-c`.'
    lists:
    - type: bullet
      items:
      - 'Prefer literal sends: `tmux -S "$SOCKET" send-keys -t target -l -- "$cmd"`.'
      - 'Control keys: `tmux -S "$SOCKET" send-keys -t target C-c`.'
  - title: Watching output
    content: '- Capture recent history: `tmux -S "$SOCKET" capture-pane -p -J -t target
      -S -200`.

      - Wait for prompts: `{baseDir}/scripts/wait-for-text.sh -t session:0.0 -p ''pattern''`.

      - Attaching is OK; detach with `Ctrl+b d`.'
    lists:
    - type: bullet
      items:
      - 'Capture recent history: `tmux -S "$SOCKET" capture-pane -p -J -t target -S
        -200`.'
      - 'Wait for prompts: `{baseDir}/scripts/wait-for-text.sh -t session:0.0 -p ''pattern''`.'
      - Attaching is OK; detach with `Ctrl+b d`.
  - title: Spawning processes
    content: '- For python REPLs, set `PYTHON_BASIC_REPL=1` (non-basic REPL breaks
      send-keys flows).'
    lists:
    - type: bullet
      items:
      - For python REPLs, set `PYTHON_BASIC_REPL=1` (non-basic REPL breaks send-keys
        flows).
  - title: Windows / WSL
    content: '- tmux is supported on macOS/Linux. On Windows, use WSL and install
      tmux inside WSL.

      - This skill is gated to `darwin`/`linux` and requires `tmux` on PATH.'
    lists:
    - type: bullet
      items:
      - tmux is supported on macOS/Linux. On Windows, use WSL and install tmux inside
        WSL.
      - This skill is gated to `darwin`/`linux` and requires `tmux` on PATH.
  - title: Orchestrating Coding Agents (Codex, Claude Code)
    content: 'tmux excels at running multiple coding agents in parallel:


      ```bash

      SOCKET="${TMPDIR:-/tmp}/codex-army.sock"'
- title: Create multiple sessions
  content: "for i in 1 2 3 4 5; do\n  tmux -S \"$SOCKET\" new-session -d -s \"agent-$i\"\
    \ndone"
- title: Launch agents in different workdirs
  content: 'tmux -S "$SOCKET" send-keys -t agent-1 "cd /tmp/project1 && codex --yolo
    ''Fix bug X''" Enter

    tmux -S "$SOCKET" send-keys -t agent-2 "cd /tmp/project2 && codex --yolo ''Fix
    bug Y''" Enter'
- title: Poll for completion (check if prompt returned)
  content: "for sess in agent-1 agent-2; do\n  if tmux -S \"$SOCKET\" capture-pane\
    \ -p -t \"$sess\" -S -3 | grep -q \"‚ùØ\"; then\n    echo \"$sess: DONE\"\n  else\n\
    \    echo \"$sess: Running...\"\n  fi\ndone"
- title: Get full output from completed session
  content: 'tmux -S "$SOCKET" capture-pane -p -t agent-1 -S -500

    ```


    **Tips:**

    - Use separate git worktrees for parallel fixes (no branch conflicts)

    - `pnpm install` first before running codex in fresh clones

    - Check for shell prompt (`‚ùØ` or `$`) to detect completion

    - Codex needs `--yolo` or `--full-auto` for non-interactive fixes'
  subsections:
  - title: Cleanup
    content: '- Kill a session: `tmux -S "$SOCKET" kill-session -t "$SESSION"`.

      - Kill all sessions on a socket: `tmux -S "$SOCKET" list-sessions -F ''#{session_name}''
      | xargs -r -n1 tmux -S "$SOCKET" kill-session -t`.

      - Remove everything on the private socket: `tmux -S "$SOCKET" kill-server`.'
    lists:
    - type: bullet
      items:
      - 'Kill a session: `tmux -S "$SOCKET" kill-session -t "$SESSION"`.'
      - 'Kill all sessions on a socket: `tmux -S "$SOCKET" list-sessions -F ''#{session_name}''
        | xargs -r -n1 tmux -S "$SOCKET" kill-session -t`.'
      - 'Remove everything on the private socket: `tmux -S "$SOCKET" kill-server`.'
  - title: 'Helper: wait-for-text.sh'
    content: '`{baseDir}/scripts/wait-for-text.sh` polls a pane for a regex (or fixed
      string) with a timeout.




      - `-t`/`--target` pane target (required)

      - `-p`/`--pattern` regex to match (required); add `-F` for fixed string

      - `-T` timeout seconds (integer, default 15)

      - `-i` poll interval seconds (default 0.5)

      - `-l` history lines to search (integer, default 1000)'
    code_blocks:
    - language: bash
      content: '{baseDir}/scripts/wait-for-text.sh -t session:0.0 -p ''pattern'' [-F]
        [-T 20] [-i 0.5] [-l 2000]'
    lists:
    - type: bullet
      items:
      - '`-t`/`--target` pane target (required)'
      - '`-p`/`--pattern` regex to match (required); add `-F` for fixed string'
      - '`-T` timeout seconds (integer, default 15)'
      - '`-i` poll interval seconds (default 0.5)'
      - '`-l` history lines to search (integer, default 1000)'
