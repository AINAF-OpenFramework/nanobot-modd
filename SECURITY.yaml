_meta:
  source: SECURITY.md
  format_version: '1.0'
title: Security Policy
sections:
- title: Security Policy
  subsections:
  - title: Reporting a Vulnerability
    content: "If you discover a security vulnerability in nanobot, please report it\
      \ by:\n\n1. **DO NOT** open a public GitHub issue\n2. Create a private security\
      \ advisory on GitHub or contact the repository maintainers\n3. Include:\n  \
      \ - Description of the vulnerability\n   - Steps to reproduce\n   - Potential\
      \ impact\n   - Suggested fix (if any)\n\nWe aim to respond to security reports\
      \ within 48 hours."
    lists:
    - type: numbered
      items:
      - '**DO NOT** open a public GitHub issue'
      - Create a private security advisory on GitHub or contact the repository maintainers
      - 'Include:'
  - title: Security Best Practices
    subsections:
    - title: 1. API Key Management
      content: '**CRITICAL**: Never commit API keys to version control.


        ```bash'
- title: '✅ Good: Store in config file with restricted permissions'
  content: chmod 600 ~/.nanobot/config.json
- title: '❌ Bad: Hardcoding keys in code or committing them'
  content: '```


    **Recommendations:**

    - Store API keys in `~/.nanobot/config.json` with file permissions set to `0600`

    - Consider using environment variables for sensitive keys

    - Use OS keyring/credential manager for production deployments

    - Rotate API keys regularly

    - Use separate API keys for development and production'
  subsections:
  - title: 2. Channel Access Control
    content: '**IMPORTANT**: Always configure `allowFrom` lists for production use.




      **Security Notes:**

      - Empty `allowFrom` list will **ALLOW ALL** users (open by default for personal
      use)

      - Get your Telegram user ID from `@userinfobot`

      - Use full phone numbers with country code for WhatsApp

      - Review access logs regularly for unauthorized access attempts'
    code_blocks:
    - language: json
      content: "{\n  \"channels\": {\n    \"telegram\": {\n      \"enabled\": true,\n\
        \      \"token\": \"YOUR_BOT_TOKEN\",\n      \"allowFrom\": [\"123456789\"\
        , \"987654321\"]\n    },\n    \"whatsapp\": {\n      \"enabled\": true,\n\
        \      \"allowFrom\": [\"+1234567890\"]\n    }\n  }\n}"
  - title: 3. Shell Command Execution
    content: 'The `exec` tool can execute shell commands. While dangerous command
      patterns are blocked, you should:


      - ✅ Review all tool usage in agent logs

      - ✅ Understand what commands the agent is running

      - ✅ Use a dedicated user account with limited privileges

      - ✅ Never run nanobot as root

      - ❌ Don''t disable security checks

      - ❌ Don''t run on systems with sensitive data without careful review


      **Blocked patterns:**

      - `rm -rf /` - Root filesystem deletion

      - Fork bombs

      - Filesystem formatting (`mkfs.*`)

      - Raw disk writes

      - Other destructive operations'
    lists:
    - type: bullet
      items:
      - ✅ Review all tool usage in agent logs
      - ✅ Understand what commands the agent is running
      - ✅ Use a dedicated user account with limited privileges
      - ✅ Never run nanobot as root
      - ❌ Don't disable security checks
      - ❌ Don't run on systems with sensitive data without careful review
  - title: 4. File System Access
    content: 'File operations have path traversal protection, but:


      - ✅ Run nanobot with a dedicated user account

      - ✅ Use filesystem permissions to protect sensitive directories

      - ✅ Regularly audit file operations in logs

      - ❌ Don''t give unrestricted access to sensitive files'
    lists:
    - type: bullet
      items:
      - ✅ Run nanobot with a dedicated user account
      - ✅ Use filesystem permissions to protect sensitive directories
      - ✅ Regularly audit file operations in logs
      - ❌ Don't give unrestricted access to sensitive files
  - title: 5. Network Security
    content: '**API Calls:**

      - All external API calls use HTTPS by default

      - Timeouts are configured to prevent hanging requests

      - Consider using a firewall to restrict outbound connections if needed


      **WhatsApp Bridge:**

      - The bridge binds to `127.0.0.1:3001` (localhost only, not accessible from
      external network)

      - Set `bridgeToken` in config to enable shared-secret authentication between
      Python and Node.js

      - Keep authentication data in `~/.nanobot/whatsapp-auth` secure (mode 0700)'
  - title: 6. Dependency Security
    content: '**Critical**: Keep dependencies updated!


      ```bash'
- title: Check for vulnerable dependencies
  content: 'pip install pip-audit

    pip-audit'
- title: Update to latest secure versions
  content: 'pip install --upgrade nanobot-ai

    bash

    cd bridge

    npm audit

    npm audit fix

    ```


    **Important Notes:**

    - Keep `litellm` updated to the latest version for security fixes

    - We''ve updated `ws` to `>=8.17.1` to fix DoS vulnerability

    - Run `pip-audit` or `npm audit` regularly

    - Subscribe to security advisories for nanobot and its dependencies'
  code_blocks:
  - language: ''
    content: 'For Node.js dependencies (WhatsApp bridge):'
  subsections:
  - title: 7. Production Deployment
    content: "For production use:\n\n1. **Isolate the Environment**\n   \n\n2. **Use\
      \ a Dedicated User**\n   \n\n3. **Set Proper Permissions**\n   \n\n4. **Enable\
      \ Logging**\n   \n\n5. **Use Rate Limiting**\n   - Configure rate limits on\
      \ your API providers\n   - Monitor usage for anomalies\n   - Set spending limits\
      \ on LLM APIs\n\n6. **Regular Updates**"
    code_blocks:
    - language: bash
      content: "# Run in a container or VM\n   docker run --rm -it python:3.11\n \
        \  pip install nanobot-ai"
    - language: bash
      content: "sudo useradd -m -s /bin/bash nanobot\n   sudo -u nanobot nanobot gateway"
    - language: bash
      content: "chmod 700 ~/.nanobot\n   chmod 600 ~/.nanobot/config.json\n   chmod\
        \ 700 ~/.nanobot/whatsapp-auth"
    - language: bash
      content: "# Configure log monitoring\n   tail -f ~/.nanobot/logs/nanobot.log"
    - language: bash
      content: "# Check for updates weekly\n   pip install --upgrade nanobot-ai"
    lists:
    - type: numbered
      items:
      - '**Isolate the Environment**'
    - type: numbered
      items:
      - '**Use a Dedicated User**'
    - type: numbered
      items:
      - '**Set Proper Permissions**'
    - type: numbered
      items:
      - '**Enable Logging**'
    - type: numbered
      items:
      - '**Use Rate Limiting**'
    - type: numbered
      items:
      - '**Regular Updates**'
  - title: 8. Development vs Production
    content: '**Development:**

      - Use separate API keys

      - Test with non-sensitive data

      - Enable verbose logging

      - Use a test Telegram bot


      **Production:**

      - Use dedicated API keys with spending limits

      - Restrict file system access

      - Enable audit logging

      - Regular security reviews

      - Monitor for unusual activity'
  - title: 9. Data Privacy
    content: '- **Logs may contain sensitive information** - secure log files appropriately

      - **LLM providers see your prompts** - review their privacy policies

      - **Chat history is stored locally** - protect the `~/.nanobot` directory

      - **API keys are in plain text** - use OS keyring for production'
    lists:
    - type: bullet
      items:
      - '**Logs may contain sensitive information** - secure log files appropriately'
      - '**LLM providers see your prompts** - review their privacy policies'
      - '**Chat history is stored locally** - protect the `~/.nanobot` directory'
      - '**API keys are in plain text** - use OS keyring for production'
  - title: 10. Incident Response
    content: "If you suspect a security breach:\n\n1. **Immediately revoke compromised\
      \ API keys**\n2. **Review logs for unauthorized access**\n   \n3. **Check for\
      \ unexpected file modifications**\n4. **Rotate all credentials**\n5. **Update\
      \ to latest version**\n6. **Report the incident** to maintainers"
    code_blocks:
    - language: bash
      content: grep "Access denied" ~/.nanobot/logs/nanobot.log
    lists:
    - type: numbered
      items:
      - '**Immediately revoke compromised API keys**'
      - '**Review logs for unauthorized access**'
      - '**Check for unexpected file modifications**'
      - '**Rotate all credentials**'
      - '**Update to latest version**'
      - '**Report the incident** to maintainers'
  - title: Security Features
    subsections:
    - title: Built-in Security Controls
      content: '✅ **Input Validation**

        - Path traversal protection on file operations

        - Dangerous command pattern detection

        - Input length limits on HTTP requests


        ✅ **Authentication**

        - Allow-list based access control

        - Failed authentication attempt logging

        - Open by default (configure allowFrom for production use)


        ✅ **Resource Protection**

        - Command execution timeouts (60s default)

        - Output truncation (10KB limit)

        - HTTP request timeouts (10-30s)


        ✅ **Secure Communication**

        - HTTPS for all external API calls

        - TLS for Telegram API

        - WhatsApp bridge: localhost-only binding + optional token auth'
  - title: Known Limitations
    content: '⚠️ **Current Security Limitations:**


      1. **No Rate Limiting** - Users can send unlimited messages (add your own if
      needed)

      2. **Plain Text Config** - API keys stored in plain text (use keyring for production)

      3. **No Session Management** - No automatic session expiry

      4. **Limited Command Filtering** - Only blocks obvious dangerous patterns

      5. **No Audit Trail** - Limited security event logging (enhance as needed)'
    lists:
    - type: numbered
      items:
      - '**No Rate Limiting** - Users can send unlimited messages (add your own if
        needed)'
      - '**Plain Text Config** - API keys stored in plain text (use keyring for production)'
      - '**No Session Management** - No automatic session expiry'
      - '**Limited Command Filtering** - Only blocks obvious dangerous patterns'
      - '**No Audit Trail** - Limited security event logging (enhance as needed)'
  - title: Security Checklist
    content: 'Before deploying nanobot:


      - [ ] API keys stored securely (not in code)

      - [ ] Config file permissions set to 0600

      - [ ] `allowFrom` lists configured for all channels

      - [ ] Running as non-root user

      - [ ] File system permissions properly restricted

      - [ ] Dependencies updated to latest secure versions

      - [ ] Logs monitored for security events

      - [ ] Rate limits configured on API providers

      - [ ] Backup and disaster recovery plan in place

      - [ ] Security review of custom skills/tools'
    lists:
    - type: checkbox
      items:
      - text: API keys stored securely (not in code)
        checked: false
      - text: Config file permissions set to 0600
        checked: false
      - text: '`allowFrom` lists configured for all channels'
        checked: false
      - text: Running as non-root user
        checked: false
      - text: File system permissions properly restricted
        checked: false
      - text: Dependencies updated to latest secure versions
        checked: false
      - text: Logs monitored for security events
        checked: false
      - text: Rate limits configured on API providers
        checked: false
      - text: Backup and disaster recovery plan in place
        checked: false
      - text: Security review of custom skills/tools
        checked: false
  - title: Updates
    content: '**Last Updated**: 2026-02-03


      For the latest security updates and announcements, check:

      - GitHub Security Advisories: https://github.com/HKUDS/nanobot/security/advisories

      - Release Notes: https://github.com/HKUDS/nanobot/releases'
  - title: License
    content: See LICENSE file for details.
